import{w as _}from"./with-props-BqwZr1IK.js";import{r as s,a as N,j as e,L as r,M as O,f as z,S as W,h as B,O as P}from"./chunk-IR6S3I6Y-C6Zvu3tq.js";import{u as L,a as T,b as H,U as $}from"./UserContext-BcfRxPbJ.js";import{m as p}from"./proxy-7hmYPAw3.js";import{A as R}from"./index-CrwWTF06.js";const V=({isScrolled:l=!1,gradientStyle:x={}})=>{var k;const{user:t,logout:m}=L(),[c,d]=s.useState(!1),[o,a]=s.useState(!1),[b,y]=s.useState(!1),[v,S]=s.useState(!1),C=N(),[f,j]=s.useState(!1),M=({setNotif:n})=>(s.useEffect(()=>{const i=setTimeout(()=>{n(!1)},5e3);return()=>clearTimeout(i)},[f]),e.jsx(p.div,{initial:{x:300,opacity:0},animate:{x:0,opacity:1},exit:{x:300,opacity:0},transition:{type:"spring",stiffness:100},className:"fixed top-13 right-5 bg-blue-500 text-white px-4 py-2 rounded-lg shadow-lg",children:e.jsx(r,{to:"/dashboard",children:"New Notification"})})),h=s.useRef(null);s.useEffect(()=>{if(!t)return;if(!h.current||h.current.readyState>1){const i=window.location.protocol==="https:"?"wss":"ws",u=window.location.hostname;h.current=new WebSocket(`${i}://${u}:8000/ws/volunteers/`)}const n=h.current;return n.onopen=()=>{console.log("âœ… WebSocket connected!")},n.onmessage=i=>{var g;((g=JSON.parse(i.data).message)==null?void 0:g.to_volunteer)===t.email&&j(!0)},n.onerror=i=>{console.error("âŒ WebSocket error:",i)},n.onclose=i=>{console.warn(`âš ï¸ WebSocket closed! Code: ${i.code}`),setTimeout(()=>{const u=window.location.protocol==="https:"?"wss":"ws",g=window.location.hostname;h.current=new WebSocket(`${u}://${g}:8000/ws/volunteers/`)},3e3)},()=>{n.close()}},[t]),s.useEffect(()=>{const n=setTimeout(()=>{a(!0)},1e3);return()=>clearTimeout(n)},[]);const w=()=>{m(),C("/")};return e.jsxs("nav",{className:"fixed w-full z-50",children:[e.jsx(p.div,{initial:{scaleY:0},animate:{scaleY:o?1:0,opacity:o?1:0},transition:{duration:.8,ease:"easeOut"},className:"h-1 w-full bg-gradient-to-r from-blue-500 via-emerald-400 to-blue-500 bg-[length:200%_auto] animate-gradient"}),e.jsx("div",{className:"bg-white/80 backdrop-blur-sm border-b border-gray-100",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between h-16",children:[e.jsx("div",{className:"flex",children:e.jsx(r,{to:t?"/dashboard":"/",className:"flex-shrink-0 flex items-center",children:e.jsx("span",{className:`transition-all duration-500 transform ${l?"animate-gradient bg-gradient-to-r from-blue-600 via-green-500 to-blue-600 bg-[length:200%_auto] bg-clip-text text-transparent text-xl font-semibold":"text-xl font-semibold text-gray-900"}`,style:l?x:{},children:"Volunteera"})})}),f&&e.jsx(M,{setNotif:j}),e.jsxs("div",{className:"hidden sm:flex sm:items-center sm:space-x-6",children:[!t&&e.jsx(r,{to:"/",className:"px-3 py-2 text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Home"}),e.jsx(r,{to:"/browse",className:"px-3 py-2 text-sm font-medium text-gray-600 hover:text-gray-900 transition-colors",children:"Browse"}),t?e.jsxs("div",{className:"relative ml-3",children:[e.jsx("button",{onClick:()=>S(!v),className:"flex items-center space-x-3 focus:outline-none group",children:e.jsxs("div",{className:"flex items-center",children:[t.is_organization&&e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded-full",children:"Organization"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[t.avatar_url?e.jsx("img",{src:t.avatar_url,alt:"Profile",className:"w-8 h-8 rounded-full object-cover border border-gray-200 group-hover:border-blue-400 transition-all"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-green-400 flex items-center justify-center text-white group-hover:shadow-md transition-all",children:((k=t.email)==null?void 0:k.charAt(0).toUpperCase())||"?"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 group-hover:text-blue-600 transition-colors",children:t.email}),e.jsx("svg",{className:`h-4 w-4 text-gray-500 transition-all duration-300 group-hover:text-blue-500 ${v?"rotate-180 text-blue-500":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]})}),v&&e.jsxs(p.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},className:"absolute right-0 mt-3 w-56 rounded-xl shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-50 overflow-hidden",children:[e.jsx("div",{className:"py-1",children:e.jsxs(r,{to:"/dashboard",className:"group flex items-center px-4 py-2.5 text-sm text-gray-700 hover:bg-blue-50 transition-colors",children:[e.jsx("svg",{className:"mr-3 h-4 w-4 text-gray-400 group-hover:text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Dashboard"]})}),t.is_organization&&e.jsx("div",{className:"py-1 border-t border-gray-100",children:e.jsxs(r,{to:"/opportunities/create",className:"group flex items-center px-4 py-2.5 text-sm text-gray-700 hover:bg-blue-50 transition-colors",children:[e.jsx("svg",{className:"mr-3 h-4 w-4 text-gray-400 group-hover:text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Create Opportunity"]})}),!t.is_organization&&e.jsx("div",{className:"py-1 border-t border-gray-100",children:e.jsxs(r,{to:"/friends",className:"group flex items-center px-4 py-2.5 text-sm text-gray-700 hover:bg-blue-50 transition-colors",children:[e.jsx("svg",{className:"mr-3 h-4 w-4 text-gray-400 group-hover:text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),"Friends"]})}),e.jsx("div",{className:"py-1 border-t border-gray-100",children:e.jsxs(r,{to:"/leaderboard",className:"group flex items-center px-4 py-2.5 text-sm text-gray-700 hover:bg-blue-50 transition-colors",children:[e.jsx("svg",{className:"mr-3 h-4 w-4 text-gray-400 group-hover:text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Leaderboard"]})}),e.jsx("div",{className:"py-1 border-t border-gray-100",children:e.jsxs(r,{to:"/about",className:"group flex items-center px-4 py-2.5 text-sm text-gray-700 hover:bg-blue-50 transition-colors",children:[e.jsx("svg",{className:"mr-3 h-4 w-4 text-gray-400 group-hover:text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"About Us"]})}),e.jsx("div",{className:"py-1 border-t border-gray-100 bg-red-50",children:e.jsxs("button",{onClick:w,className:"group flex w-full items-center px-4 py-2.5 text-sm text-red-600 hover:bg-red-100 transition-colors",children:[e.jsx("svg",{className:"mr-3 h-4 w-4 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),"Logout"]})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>y(!b),onBlur:()=>setTimeout(()=>y(!1),100),className:"px-4 py-2 text-sm font-medium rounded-full text-white bg-gray-900 hover:bg-gray-800 transition-colors flex items-center",children:["Register",e.jsx("svg",{className:`ml-2 h-4 w-4 transition-transform ${b?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),b&&e.jsxs(p.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute right-0 mt-2 w-48 rounded-lg shadow-lg bg-white ring-1 ring-black ring-opacity-5",children:[e.jsxs(r,{to:"/register/volunteer",state:{type:"volunteer"},className:"block px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 rounded-t-lg flex items-center",children:[e.jsx("span",{className:"text-lg mr-2",children:"ðŸ¤"}),"I'm a Volunteer"]}),e.jsxs(r,{to:"/register",state:{type:"organization"},className:"block px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 rounded-b-lg flex items-center",children:[e.jsx("span",{className:"text-lg mr-2",children:"ðŸ¢"}),"I'm an Organization"]})]})]}),e.jsxs(r,{to:"/login",className:"ml-3 px-4 py-2 text-sm font-medium rounded-full text-blue-600 border border-blue-200 hover:bg-blue-50 hover:border-blue-300 transition-colors flex items-center",children:[e.jsx("svg",{className:"mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),"Login"]})]})]}),e.jsx("div",{className:"sm:hidden flex items-center bg-white",children:e.jsxs("button",{onClick:()=>d(!c),className:"inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100",children:[e.jsx("span",{className:"sr-only",children:"Open main menu"}),e.jsx("svg",{className:`${c?"hidden":"block"} h-6 w-6`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),e.jsx("svg",{className:`${c?"block":"hidden"} h-6 w-6`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})})]})})}),e.jsx("div",{className:`${c?"block":"hidden"} sm:hidden bg-white`,children:e.jsxs("div",{className:"pt-2 pb-3 space-y-1",children:[!t&&e.jsx(r,{to:"/",className:"block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"Home"}),e.jsx(r,{to:"/browse",className:"block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"Browse"}),t?e.jsxs(e.Fragment,{children:[e.jsx(r,{to:"/dashboard",className:"block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"Dashboard"}),t.is_organization&&e.jsx(r,{to:"/opportunities/create",className:"block px-3 py-2 text-base font-medium text-green-600 hover:text-green-700 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Create Opportunity"]})}),!t.is_organization&&e.jsx(r,{to:"/friends",className:"block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"Friends"}),e.jsx(r,{to:"/leaderboard",className:"block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"Leaderboard"}),e.jsx(r,{to:"/about",className:"block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"About Us"}),e.jsxs("div",{className:"px-3 py-2",children:[t.is_organization&&e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full",children:"Organization"}),e.jsx("span",{className:"block mt-1 text-sm font-medium text-gray-700",children:t.email})]}),e.jsx("button",{onClick:w,className:"block w-full text-left px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"Logout"})]}):e.jsxs(e.Fragment,{children:[e.jsxs(r,{to:"/login",className:"block px-3 py-2 text-base font-medium text-blue-600 hover:text-blue-700 hover:bg-blue-50 flex items-center",children:[e.jsx("svg",{className:"mr-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),"Login"]}),e.jsxs("div",{className:"px-3 py-2 space-y-1",children:[e.jsx(r,{to:"/register",state:{type:"volunteer"},className:"block px-4 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"Register as Volunteer"}),e.jsx(r,{to:"/register",state:{type:"organization"},className:"block px-4 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50",children:"Register as Organization"})]})]})]})})]})},E=({children:l})=>{const x=N(),{user:t,login:m}=L();return T({onSuccess:async d=>{try{const o=await fetch("/api/auth/google/callback/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({credential:d.credential,user_type:"volunteer"})}),a=await o.json();if(!o.ok)throw new Error(a.error||"Login failed");localStorage.setItem("access_token",a.access),localStorage.setItem("refresh_token",a.refresh),m(a.user),x("/dashboard")}catch(o){console.error("Google One Tap error:",o),alert("Login failed: "+o.message)}},onError:d=>{console.error("Google One Tap login failed:",d),alert("Google login failed. Please try again.")},disabled:!!t,auto_select:!0,use_fedcm_for_prompt:!0,cancel_on_tap_outside:!1}),l};function F({children:l}){return e.jsxs("html",{lang:"en",children:[e.jsxs("head",{children:[e.jsx("meta",{charSet:"UTF-8"}),e.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),e.jsx("title",{children:"Volunterra"}),e.jsx(O,{}),e.jsx(z,{})]}),e.jsxs("body",{children:[l,e.jsx(W,{}),e.jsx(B,{})]})]})}const Y=_(function(){const[x,t]=s.useState(!1),[m,c]=s.useState(0);s.useEffect(()=>{const o=()=>{const a=window.scrollY;t(a>50),c(a*.2)};return window.addEventListener("scroll",o),()=>window.removeEventListener("scroll",o)},[]);const d={backgroundPosition:`${m}% 50%`};return e.jsx(H,{clientId:"1032409090840-gus43isikcnuq4n365l7gocm53h725dl.apps.googleusercontent.com",children:e.jsx($,{children:e.jsx(E,{children:e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(V,{isScrolled:x,gradientStyle:d}),e.jsx(R,{mode:"wait",children:e.jsx("main",{className:"pt-16",children:e.jsx(P,{})})})]})})})})});export{F as Layout,Y as default};
