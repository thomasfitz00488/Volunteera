import{r as n,R as J,j as H}from"./chunk-IR6S3I6Y-C6Zvu3tq.js";function T(o={}){const{nonce:i,onScriptLoadSuccess:e,onScriptLoadError:v}=o,[s,u]=n.useState(!1),d=n.useRef(e);d.current=e;const t=n.useRef(v);return t.current=v,n.useEffect(()=>{const l=document.createElement("script");return l.src="https://accounts.google.com/gsi/client",l.async=!0,l.defer=!0,l.nonce=i,l.onload=()=>{var c;u(!0),(c=d.current)===null||c===void 0||c.call(d)},l.onerror=()=>{var c;u(!1),(c=t.current)===null||c===void 0||c.call(t)},document.body.appendChild(l),()=>{document.body.removeChild(l)}},[i]),s}const M=n.createContext(null);function F({clientId:o,nonce:i,onScriptLoadSuccess:e,onScriptLoadError:v,children:s}){const u=T({nonce:i,onScriptLoadSuccess:e,onScriptLoadError:v}),d=n.useMemo(()=>({clientId:o,scriptLoadedSuccessfully:u}),[o,u]);return J.createElement(M.Provider,{value:d},s)}function N(){const o=n.useContext(M);if(!o)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return o}function P(o){var i;return(i=o==null?void 0:o.clientId)!==null&&i!==void 0?i:o==null?void 0:o.client_id}const V={large:40,medium:32,small:20};function K({onSuccess:o,onError:i,useOneTap:e,promptMomentNotification:v,type:s="standard",theme:u="outline",size:d="large",text:t,shape:l,logo_alignment:c,width:C,locale:G,click_listener:O,containerProps:g,...U}){const x=n.useRef(null),{clientId:I,scriptLoadedSuccessfully:h}=N(),y=n.useRef(o);y.current=o;const _=n.useRef(i);_.current=i;const E=n.useRef(v);return E.current=v,n.useEffect(()=>{var S,m,b,r,a,f,R,j,k;if(h)return(b=(m=(S=window==null?void 0:window.google)===null||S===void 0?void 0:S.accounts)===null||m===void 0?void 0:m.id)===null||b===void 0||b.initialize({client_id:I,callback:w=>{var L;if(!(w!=null&&w.credential))return(L=_.current)===null||L===void 0?void 0:L.call(_);const{credential:A,select_by:B}=w;y.current({credential:A,clientId:P(w),select_by:B})},...U}),(f=(a=(r=window==null?void 0:window.google)===null||r===void 0?void 0:r.accounts)===null||a===void 0?void 0:a.id)===null||f===void 0||f.renderButton(x.current,{type:s,theme:u,size:d,text:t,shape:l,logo_alignment:c,width:C,locale:G,click_listener:O}),e&&((k=(j=(R=window==null?void 0:window.google)===null||R===void 0?void 0:R.accounts)===null||j===void 0?void 0:j.id)===null||k===void 0||k.prompt(E.current)),()=>{var w,L,A;e&&((A=(L=(w=window==null?void 0:window.google)===null||w===void 0?void 0:w.accounts)===null||L===void 0?void 0:L.id)===null||A===void 0||A.cancel())}},[I,h,e,s,u,d,t,l,c,C,G]),J.createElement("div",{...g,ref:x,style:{height:V[d],...g==null?void 0:g.style}})}function q(){var o,i,e;(e=(i=(o=window==null?void 0:window.google)===null||o===void 0?void 0:o.accounts)===null||i===void 0?void 0:i.id)===null||e===void 0||e.disableAutoSelect()}function Q({onSuccess:o,onError:i,promptMomentNotification:e,cancel_on_tap_outside:v,prompt_parent_id:s,state_cookie_domain:u,hosted_domain:d,use_fedcm_for_prompt:t=!1,disabled:l,auto_select:c}){const{clientId:C,scriptLoadedSuccessfully:G}=N(),O=n.useRef(o);O.current=o;const g=n.useRef(i);g.current=i;const U=n.useRef(e);U.current=e,n.useEffect(()=>{var x,I,h,y,_,E,S,m,b;if(G){if(l){(h=(I=(x=window==null?void 0:window.google)===null||x===void 0?void 0:x.accounts)===null||I===void 0?void 0:I.id)===null||h===void 0||h.cancel();return}return(E=(_=(y=window==null?void 0:window.google)===null||y===void 0?void 0:y.accounts)===null||_===void 0?void 0:_.id)===null||E===void 0||E.initialize({client_id:C,callback:r=>{var a;if(!(r!=null&&r.credential))return(a=g.current)===null||a===void 0?void 0:a.call(g);const{credential:f,select_by:R}=r;O.current({credential:f,clientId:P(r),select_by:R})},hosted_domain:d,cancel_on_tap_outside:v,prompt_parent_id:s,state_cookie_domain:u,use_fedcm_for_prompt:t,auto_select:c}),(b=(m=(S=window==null?void 0:window.google)===null||S===void 0?void 0:S.accounts)===null||m===void 0?void 0:m.id)===null||b===void 0||b.prompt(U.current),()=>{var r,a,f;(f=(a=(r=window==null?void 0:window.google)===null||r===void 0?void 0:r.accounts)===null||a===void 0?void 0:a.id)===null||f===void 0||f.cancel()}}},[C,G,v,s,u,d,t,l,c])}const p=n.createContext(null),W=({children:o})=>{const[i,e]=n.useState(null),[v,s]=n.useState(!0);n.useEffect(()=>{const t=localStorage.getItem("user"),l=localStorage.getItem("access_token");t&&l&&e(JSON.parse(t)),s(!1)},[]);const u=t=>{e(t),localStorage.setItem("user",JSON.stringify(t))},d=()=>{q(),e(null),localStorage.removeItem("user"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")};return H.jsx(p.Provider,{value:{user:i,login:u,logout:d,loading:v},children:o})},X=()=>n.useContext(p);export{K as G,W as U,Q as a,F as b,X as u};
